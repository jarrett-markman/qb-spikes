---
title: "Why Quarterback Spikes Need to Change."
output:
  pdf_document: default
  html_document:
    df_print: paged
---

## Abstract

A quarterback spike is a strategy employed by every single NFL team, usually in low-clock scenarios for one purpose. To stop the clock. Whether it's within a 2-minute drill or for a final field-goal attempt or offensive play that includes either a "Hail Mary" or a bunch of laterals in an unlikely attempt to score.
Teams prepare for 2-minute drills and late game scenarios, so why are they forced to use a spike to stop the clock and essentially throw an incompletion?
In almost every end of game situation most NFL teams choose to concede a down and spike the ball to set up the next play.
It's unfair to assume teams will evaluate what to do in late-game situations, however, that got me interested.
Why do teams spike the ball anyway?
For the most part, a quarterback spike is a purposeful incompletion to stop the clock.
In some situations, stopping the clock with a spike is a necessary evil.
However, many teams misinterpret the clock and choose to spike the ball, assuming they'll need more time than necessary.

#### Step 1:
Load the libraries.
 
```{r,warning=FALSE,message=FALSE}
library(tidyverse)
library(ggrepel)
library(ggimage)
library(gt)
library(caret)
library(nflfastR)
options(scipen = 9999)
```

#### Step 2:
Create a data frame for fourth quarter spikes, loading the data from the past 10 years.

```{r}
fourth_quarter_spikes <- load_pbp(2012:2021) %>%
  filter(qb_spike == 1) %>%
  filter(qtr == 4) %>%
  filter(score_differential >=-8)
```

#### Step 3:
Look at every fourth quarter spike in the past 10 years.
 
```{r, echo=FALSE}
fourth_quarter_spikes %>%
  ggplot(aes(x=epa, y=wpa)) +
  geom_point(color = "black", shape = 1) +
  geom_hline(yintercept = mean(fourth_quarter_spikes$epa), color = 'red') +
  geom_hline(yintercept = 0) +
  geom_vline(xintercept = mean(fourth_quarter_spikes$wpa), color = 'red') +
  geom_vline(xintercept = 0) +
  labs(x = "EPA",
       y = "WPA",
       title = "EPA and WPA on Fourth Quarter Spikes",
       caption = "Data: nflfastR") +
  theme(plot.title = element_text(size = 12, face = "bold", hjust = 0.5))
```

Most of the data hovers in the negative EPA and WPA range.
The red lines indicate the average EPA and WPA per spike, and are both below 0.
Meaning that on an average spike in the past 10 years, it would have a lower win probability and expected points than the play before.

#### Step 4:
What variables are important for fourth quarter spikes?
 
```{r, echo=FALSE}
fourth_quarter_spikes %>% 
  select(posteam, defteam, time, yrdln, score_differential, epa, wpa, fg_prob) %>%
  filter(score_differential >= -3) %>%
  arrange(time)
fourth_quarter_spikes %>% 
  select(posteam, defteam, time, yrdln, score_differential, epa, wpa, fg_prob) %>%
  filter(score_differential >= -3) %>%
  arrange(-fg_prob)
fourth_quarter_spikes %>% 
  select(posteam, defteam, time, yrdln, score_differential, epa, wpa, fg_prob) %>%
  filter(score_differential >= -3) %>%
  arrange(fg_prob)
fourth_quarter_spikes %>%
  select(posteam, defteam, time, yrdln, score_differential, epa, wpa, td_prob) %>%
  filter(score_differential <= -4 & score_differential >= -8) %>%
  arrange(time)
fourth_quarter_spikes %>%
  select(posteam, defteam, time, yrdln, score_differential, epa, wpa, td_prob) %>%
  filter(score_differential <= -4 & score_differential >= -8) %>%
  arrange(-td_prob)
```

In a touchdown score game, both EPA and WPA tend to be negative.
In a field goal score game with little time left, and a high field goal probability, it makes perfect sense to spike the ball to set up a field goal to win or tie the game. EPA agrees with this, indicating that it's beneficial to set up chances to win the game. It's very impractical to spike the ball with a low field goal probability because there's really no beneficial reason to throwing a purposeful incompletion.

##### How many spikes have a negative EPA based on endgame scenarios?
 
```{r, echo = FALSE}
fourth_quarter_spikes %>%
  select(epa, score_differential) %>%
  filter(score_differential >= -3) %>%
  filter(epa < 0)
fourth_quarter_spikes %>%
  select(epa, score_differential) %>%
  filter(score_differential <= -4 & score_differential >= -8) %>%
  filter(epa < 0)
```

In field goal score games, there were 83 instances of spikes with a negative EPA, just below 60%.
In touchdown score games, there were 105 instances of spikes with a negative EPA, just below 90%.

##### What does it look like with a spike to set up a field goal to win the game?
 
```{r, echo = FALSE}
fourth_quarter_spikes %>%
  select(posteam, defteam, posteam_score, defteam_score, time, yrdln, epa, fg_prob, score_differential) %>%
  filter(score_differential > -3) %>%
  arrange(-fg_prob)
```

With a high field goal probability, less than 3 point deficit and little time remaining, EPA tends to be positive.
This makes a lot of practical sense in game-time scenarios.
If you can, it makes perfect sense to spike the ball - or throw an incompletion - before a field goal to set up a chance to win the game.

#### Step 6:
Are certain teams better with using quarterback spikes?
 
```{r, echo = FALSE}
fourth_quarter_spikes <- fourth_quarter_spikes %>%
  left_join(teams_colors_logos, by = c("posteam" = "team_abbr"))
```

##### Which teams have the highest EPA and WPA per spike?
 
```{r, echo = FALSE}
fourth_quarter_spikes %>%
  select(posteam, epa, wpa) %>%
  group_by(posteam) %>%
  summarise(avg_epa = mean(epa), avg_wpa = mean(wpa)) %>%
  arrange(-avg_epa)
```

The Eagles, Chiefs, Vikings and 49ers are some of the most efficient teams when spiking the ball in late game scenarios looking at expected points and win probability added.

Now teams can be plotted with their average EPA and WPA.
 
```{r, echo=FALSE}
fourth_quarter_spikes %>%
  select(posteam, epa, wpa) %>%
  group_by(posteam) %>%
  summarise(avg_epa = mean(epa), avg_wpa = mean(wpa)) %>%
  left_join(teams_colors_logos, by = c('posteam' = 'team_abbr')) %>%
  ggplot(aes(x=avg_epa, y=avg_wpa)) +
  geom_image(aes(image = team_logo_espn), size = 0.05) +
  labs(x= "EPA",
       y = "WPA",
       title = "Average Fourth Quarter Spike EPA and WPA by team",
       caption = "Data: nflfastR") +
  theme(plot.title = element_text(size = 10, face = "bold", hjust = 0.5)) +
  geom_segment(aes(x = mean(avg_epa), y = mean(avg_wpa), xend = mean(avg_epa), yend = 0.01)) +
  geom_segment(aes(x = mean(avg_epa), y = mean(avg_wpa), xend = 0.5, yend = mean(avg_wpa))) +
  geom_segment(aes(x = mean(avg_epa), y = mean(avg_wpa), xend = mean(avg_epa), yend = -0.05)) +
  geom_segment(aes(x = mean(avg_epa), y = mean(avg_wpa), xend = -0.3, yend = mean(avg_wpa))) 
```

The Eagles, 49ers, Vikings and Chiefs all have some advantage when spiking the ball over the last 10 years. Many of the teams just hover around the mean EPA and WPA for the league with all but 5 teams ranging from -0.04 and -0.005 WPA and -.25 and .1 EPA.


#### Step 7
Is there a way to make a multivariate linear regression model to predict the EPA of a spike?
 
I want to create 2 different models, one for field goal score games, and one for touchdown score games.
First there need to be 2 more data frames for a fg_model and a td_model.

```{r}
fg_model <- fourth_quarter_spikes %>%
  filter(score_differential >= -3) %>%
  select(epa, game_seconds_remaining, down, yardline_100, posteam_timeouts_remaining, 
         score_differential, fg_prob)
td_model <- fourth_quarter_spikes %>%
  filter(score_differential <= -4) %>%
  select(epa, game_seconds_remaining, down, yardline_100, posteam_timeouts_remaining, 
         score_differential, td_prob)
```


```{r}
fg_model <- lm(epa ~ ., data = fg_model)
td_model <- lm(epa ~ ., data = td_model)
```
 
# Here are the results!
 
#### Field Goal Situation
 
```{r, echo = FALSE}
summary(fg_model)
```

In order to spike the ball beneficially in a field goal score game, a team must have good field position and field goal probability.
It makes sense for there to be negative coefficients for seconds remaining and down because the margin for error grows larger with more time and a later down.
Additionally, if a team has at least 1 timeout, there is absolutely no need to spike the ball.

#### Touchdown Situation
 
```{r, echo = FALSE}
summary(td_model)
```

In a touchdown score game, the odds are already stacked against any team. In that situation, the model suggests than the more likely a touchdown is, the worse decision a spike is. By spiking the ball - or throwing an incompletion - that increases the likelihood of a turnover on downs and lowers the likelihood of a touchdown. The model is definitely flawed because timeouts remaining carries a positive coefficient, because, as stated, if there are any timeouts there's really no reason for a spike decision to be made. 

Let's say that a team has the ball on 1st down with 30 seconds to go on the opponents 8 yard line, down 1. 
What's the predictive EPA? Field goal probability is estimated at 70%.

``` {r, echo = FALSE}
game_seconds_remaining <- 30
down <- 1
yardline_100 <- 8
posteam_timeouts_remaining <- 0
score_differential <- 1
fg_prob <- .7
new_data <- data.frame(game_seconds_remaining, down, yardline_100, posteam_timeouts_remaining, score_differential, fg_prob)
predict(fg_model, new_data)
```

What about if they were down by 5 points instead of 1? Touchdown probability is estimated at 50%.

``` {r, echo = FALSE}
game_seconds_remaining <- 30
down <- 1
yardline_100 <- 8
posteam_timeouts_remaining <- 0
score_differential <- 5
td_prob <- .5
new_data <- data.frame(game_seconds_remaining, down, yardline_100, posteam_timeouts_remaining, score_differential, td_prob)
predict(td_model, new_data)
```

In different scenarios there's a drastic difference between a good spike and a bad spike. The biggest difference is that a field goal is so much more likely to be successful than a touchdown. The 16th best NFL team last year in redzone TD% was the Rams with ~59%, sacrificing that down lowers the odds of a touchdown, increasing the likelihood of failure. A spike doesn't hurt that much when down by a field goal because a field goal is much more attainable. 

In almost any scenario a quarterback spike is impractical. Spikes are used so frequently and so inefficiently when there are only really a select few examples when a spike is "acceptable." If the purpose of a spike in a field goal score game is to stop the clock in order to kick a field goal, that makes perfect sense. If a team is stopping the clock when they have a timeout or if there is a lot of time remaining it becomes less sensible. When down a touchdown, there's almost never a reason to spike the ball. Possibly to set up one final play but it never really makes any sense to just spike the ball to then continue the drive. As a team, you just purposefully threw an incompletion and are still trying to end up in the end zone. Spiking the ball with 30 seconds left only stunts the progress of the drive, forcing the team to - and letting the defense - reset, and then continue the drive with the same goal before the spike. It makes no sense.

## Conclusion 

Most of the time a quarterback spike is a negative play. In almost any scenario in a touchdown-score game there is no reason to spike the ball. It's a purposeful incompletion that stunts the drive, allows the defense to regroup and the goal of the drive doesn't change. The offense is then given only 3 downs, with a lower likelihood to score, in addition to not running a play failing to get more yardage, possibly a touchdown, and possibly out of bounds - Which would accomplish that goal of stopping the clock. Stopping the clock for 1 second rather than 5 only to waste a down is not worth it. It's a purposeful incompletion, preventing the offense from gaining yardage or even finding any form of success.

From all of the data from the past 10 years over half of the spikes had a negative EPA. About 90% of spikes in a touchdown score game had a negative EPA as well as about 60% of spikes in a field goal score game. In most scenarios there's no real reason to spike the ball. The only applicable scenario for a spike is for one final play. In almost all scenarios there's no reason to waste a down and throw a purposeful incompletion. The only real applicable scenario where a spike makes sense is to set up a field goal to win the game. Most of the time teams won't spike the ball with >5 seconds to kick a field goal because then there would be time left on the clock. So there's really only a small small margin of scenarios where spikes are truly applicable. Outside of a field goal to tie or win the game in the final seconds, any other scenario doesn't really make sense for a spike. 

What if a team was down 1, had a 1st and 10 at the 40, with no timeouts and 45 seconds remaining? Assume 30% field goal probability.

``` {r, echo=FALSE}
game_seconds_remaining <- 45
down <- 1
yardline_100 <- 40
posteam_timeouts_remaining <- 0
score_differential <- 1
fg_prob <- .3
new_data <- data.frame(game_seconds_remaining, down, yardline_100, posteam_timeouts_remaining, score_differential, fg_prob)
predict(fg_model, new_data)
```

In another realistic scenario it doesn't really make sense to increase the likelihood of a turnover on downs, and sacrifice the possibility of gaining more yardage for more favorable winning position. 

There's only a very very very small area where a spike actually is useful. Aside from setting up a field goal to win or tie, there are only a handful or realistic scenarios where there may be a positive EPA, however, most of the time, spikes are just a forced incompletion and loss of down, overestimating the importance of time. 

Quarterback spikes really should only be used to set up field goals to win or tie a game. Otherwise they really don't serve much of a purpose other than to hurt the flow of the drive, the offense, down, distance, field position, touchdown likelihood, first down likelihood all to spare 5 seconds to throw an incompletion rather than run a play. Quarterback spikes really just open up the margin for error, additionally sacrificing the opportunity to find more offensive success, instead stalling on the drive. Quarterback spikes need to change.
